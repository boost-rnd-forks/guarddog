rules:
  - id: maven-steganography
    languages:
      - java
    message: This package is dynamically executing hidden data from an image
    metadata:
      description: Identify when a package retrieves hidden data from an image and executes it
    patterns:
      - pattern-inside: |
          import io.github.galliumdata.adumbra;
          ...
          $ENC = new Encoder(...);
          ...
      - pattern: $ENC.encode(...)
    severity: WARNING